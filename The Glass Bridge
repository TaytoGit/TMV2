--CREDIT IS APPRECIATED :)

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

local player = Players.LocalPlayer
local pg = player:WaitForChild("PlayerGui")

local old = pg:FindFirstChild("TaytosGlassMenuUI")
if old then old:Destroy() end

local function hookWeakPanel(panel)
	if not panel or not panel:IsA("BasePart") or panel:GetAttribute("__hooked") then return end
	panel:SetAttribute("__hooked", true)
	local gw = panel.Parent
	local step = panel:FindFirstAncestor("Step")
	if not step or not gw then return end
	step.DescendantRemoving:Connect(function(inst)
		if inst == panel and gw and gw.Parent then
			local stepable = gw:FindFirstChild("stepable")
			if stepable and stepable:IsA("BasePart") then
				stepable.Color = Color3.fromRGB(0, 0, 0)
				stepable.Material = Enum.Material.SmoothPlastic
				stepable.Anchored = true
				stepable.CanCollide = true
				stepable.Transparency = 0
				stepable.CFrame = panel.CFrame
			end
		end
	end)
end

local function scanAndHookWeakPanels(root)
	for _, d in ipairs((root or workspace):GetDescendants()) do
		if d:IsA("BasePart") and d.Name == "glass_panel_weak" then
			hookWeakPanel(d)
		end
	end
end

workspace.DescendantAdded:Connect(function(d)
	if d:IsA("BasePart") and d.Name == "glass_panel_weak" then
		hookWeakPanel(d)
	end
end)

local BASE_W, BASE_H = 420, 420
local BG = Color3.fromRGB(10,10,14)
local STROKE = Color3.fromRGB(70,40,110)
local PRIMARY = Color3.fromRGB(120,85,220)
local MUTED = Color3.fromRGB(46,44,58)
local TEXT = Color3.fromRGB(235,232,255)
local SUBTEXT = Color3.fromRGB(210,205,230)

local gui = Instance.new("ScreenGui")
gui.Name = "TaytosGlassMenuUI"
gui.ResetOnSpawn = false
gui.ZIndexBehavior = Enum.ZIndexBehavior.Global
gui.DisplayOrder = 999999
gui.IgnoreGuiInset = true
gui.Parent = pg

local win = Instance.new("Frame")
win.Size = UDim2.fromOffset(BASE_W, BASE_H)
win.Position = UDim2.new(0.5,0,0.5,0)
win.AnchorPoint = Vector2.new(0.5,0.5)
win.BackgroundColor3 = BG
win.BorderSizePixel = 0
win.Parent = gui
Instance.new("UICorner", win).CornerRadius = UDim.new(0,16)
local wst = Instance.new("UIStroke", win) wst.Color = STROKE wst.Thickness = 1.5
local wgr = Instance.new("UIGradient", win) wgr.Rotation = 90
wgr.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(12,12,16)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(20,16,28)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(42,8,68)),
}

local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1,0,0,40)
titleBar.BackgroundTransparency = 1
titleBar.Parent = win

local title = Instance.new("TextLabel")
title.BackgroundTransparency = 1
title.Size = UDim2.new(1,-120,1,0)
title.Position = UDim2.fromOffset(16,0)
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left
title.TextColor3 = TEXT
title.Text = "Tayto's Glass Bridge Menu"
title.Parent = titleBar

local btnHolder = Instance.new("Frame")
btnHolder.BackgroundTransparency = 1
btnHolder.Size = UDim2.fromOffset(96,28)
btnHolder.AnchorPoint = Vector2.new(1,0.5)
btnHolder.Position = UDim2.new(1,-10,0.5,0)
btnHolder.Parent = titleBar
local bl = Instance.new("UIListLayout", btnHolder)
bl.FillDirection = Enum.FillDirection.Horizontal
bl.Padding = UDim.new(0,8)
bl.HorizontalAlignment = Enum.HorizontalAlignment.Right
bl.VerticalAlignment = Enum.VerticalAlignment.Center

local function icon(txt)
	local b = Instance.new("TextButton")
	b.Size = UDim2.fromOffset(44,28)
	b.Text = txt
	b.BackgroundColor3 = Color3.fromRGB(30,30,40)
	b.AutoButtonColor = false
	b.Font = Enum.Font.GothamSemibold
	b.TextSize = 14
	b.TextColor3 = TEXT
	Instance.new("UICorner", b).CornerRadius = UDim.new(0,8)
	local s = Instance.new("UIStroke", b) s.Color = Color3.fromRGB(80,60,120) s.Thickness = 1
	b.Parent = btnHolder
	return b
end

local closeBtn = icon("X")
local minBtn = icon("â€”")

local content = Instance.new("Frame")
content.Size = UDim2.new(1,-24,1,-64)
content.Position = UDim2.fromOffset(12,52)
content.BackgroundTransparency = 1
content.Parent = win

local lay = Instance.new("UIListLayout", content)
lay.Padding = UDim.new(0,10)
lay.SortOrder = Enum.SortOrder.LayoutOrder

local function label(txt)
	local l = Instance.new("TextLabel")
	l.Size = UDim2.new(1,0,0,20)
	l.BackgroundTransparency = 1
	l.Font = Enum.Font.GothamBold
	l.TextSize = 16
	l.TextXAlignment = Enum.TextXAlignment.Left
	l.TextColor3 = TEXT
	l.Text = txt
	l.Parent = content
	return l
end

local function pill(txt, color)
	local b = Instance.new("TextButton")
	b.Size = UDim2.new(1,0,0,44)
	b.BackgroundColor3 = color
	b.AutoButtonColor = false
	b.Font = Enum.Font.GothamSemibold
	b.TextSize = 16
	b.TextColor3 = Color3.new(1,1,1)
	b.Text = txt
	Instance.new("UICorner", b).CornerRadius = UDim.new(0,10)
	return b
end

local function halfRow()
	local f = Instance.new("Frame")
	f.Size = UDim2.new(1,0,0,44)
	f.BackgroundTransparency = 1
	f.Parent = content
	local hl = Instance.new("UIListLayout", f)
	hl.FillDirection = Enum.FillDirection.Horizontal
	hl.Padding = UDim.new(0,10)
	return f
end

label("Reveal Glass Panels")
local execBtn = pill("Execute", PRIMARY) execBtn.Parent = content

label("AFK Auto Win")
local afkRow = halfRow()
local afkEnableBtn = pill("Enable", PRIMARY) afkEnableBtn.Size = UDim2.new(0.5,-5,1,0) afkEnableBtn.Parent = afkRow
local afkDisableBtn = pill("Disabled", MUTED) afkDisableBtn.TextColor3 = TEXT afkDisableBtn.Size = UDim2.new(0.5,-5,1,0) afkDisableBtn.Parent = afkRow

label("Auto Win")
local row = halfRow()
local enableBtn = pill("Enable", PRIMARY) enableBtn.Size = UDim2.new(0.5,-5,1,0) enableBtn.Parent = row
local disableBtn = pill("Disabled", MUTED) disableBtn.TextColor3 = TEXT disableBtn.Size = UDim2.new(0.5,-5,1,0) disableBtn.Parent = row

label("Bypass Anti Cheat (With Infinite Yield)")
local acBtn = pill("Enable", PRIMARY) acBtn.Parent = content

local status = Instance.new("TextLabel")
status.BackgroundTransparency = 1
status.Size = UDim2.new(1,0,0,20)
status.Font = Enum.Font.Gotham
status.TextSize = 14
status.TextXAlignment = Enum.TextXAlignment.Left
status.TextColor3 = SUBTEXT
status.Text = "Status: Ready"
status.Parent = content

execBtn.MouseButton1Click:Connect(function()
	status.Text = "Status: Revealing..."
	for _, step in ipairs(workspace:GetChildren()) do
		if step:IsA("Model") and step.Name == "Step" then
			local gt = step:FindFirstChild("glass_tempered")
			if gt then
				local gp = gt:FindFirstChild("glass_panel")
				if gp and gp:IsA("BasePart") then gp.Color = Color3.fromRGB(0,255,0) end
			end
			local gw = step:FindFirstChild("glass_weak")
			if gw then
				local weak = gw:FindFirstChild("glass_panel_weak")
				if weak and weak:IsA("BasePart") then
					weak.Color = Color3.fromRGB(255,0,0)
					if not gw:FindFirstChild("stepable") then
						local clone = weak:Clone()
						clone.Name = "stepable"
						clone.Anchored = true
						clone.CanCollide = true
						clone.Transparency = 0
						clone.CFrame = weak.CFrame
						clone.Parent = gw
					end
				end
				local detector = gw:FindFirstChild("Detector")
				if detector then detector:Destroy() end
			end
		end
	end
	for _, inst in ipairs(workspace:GetDescendants()) do
		if typeof(inst.Name) == "string" and inst.Name:lower() == "lobby" then pcall(function() inst:Destroy() end) end
	end
	workspace.ChildAdded:Connect(function(child)
		if typeof(child.Name) == "string" and child.Name:lower() == "lobby" then pcall(function() child:Destroy() end) end
	end)
	workspace.DescendantAdded:Connect(function(desc)
		if typeof(desc.Name) == "string" and desc.Name:lower() == "lobby" then pcall(function() desc:Destroy() end) return end
		local p = desc.Parent
		while p do
			if typeof(p.Name) == "string" and p.Name:lower() == "lobby" then pcall(function() p:Destroy() end) break end
			p = p.Parent
		end
	end)
	for _, inst in ipairs(workspace:GetDescendants()) do
		if typeof(inst.Name) == "string" and inst.Name:match("PushZ") then pcall(function() inst:Destroy() end) end
	end
	local existing = workspace:FindFirstChild("OOOOOOOOOOOKKK")
	if existing then pcall(function() existing:Destroy() end) end
	local pad = Instance.new("Part")
	pad.Name = "OOOOOOOOOOOKKK"
	pad.Anchored = true
	pad.Size = Vector3.new(350, 2, 400)
	pad.CFrame = CFrame.new(-116.751099, 47.6960335, 88.6486359)
	pad.Transparency = 0.75
	pad.Parent = workspace
	scanAndHookWeakPanels()
	status.Text = "Status: Reveal complete"
end)

local afkEnabled = false
local afkTouchConn
local exitPart, exitOrigCFrame, exitOrigSize, exitOrigAnchored
local winAFKPart, winAFKOrigCFrame, winAFKOrigSize, winAFKOrigAnchored
local EXIT_TARGET_CF = CFrame.new(-16.897646, 62.6035919, 224.13765, -1,0,0, 0,1,0, 0,0,-1)
local EXIT_TARGET_SIZE = Vector3.new(39.866695404052734, 26.350013732910156, 39.56122589111328)
local lastTouchAt = 0

local function setAFKEnabledUI()
	afkEnableBtn.Text = "Enabled"
	afkEnableBtn.BackgroundColor3 = Color3.fromRGB(70,68,90)
	afkDisableBtn.Text = "Disable"
	afkDisableBtn.BackgroundColor3 = PRIMARY
	afkDisableBtn.TextColor3 = Color3.new(1,1,1)
end

local function setAFKDisabledUI()
	afkEnableBtn.Text = "Enable"
	afkEnableBtn.BackgroundColor3 = PRIMARY
	afkDisableBtn.Text = "Disabled"
	afkDisableBtn.BackgroundColor3 = MUTED
	afkDisableBtn.TextColor3 = TEXT
end

afkEnableBtn.MouseButton1Click:Connect(function()
	if afkEnabled then return end
	if _G.__AutoWinEnabled then status.Text = "Status: Disable Auto Win first"; return end

	exitPart = workspace:FindFirstChild("EXIT")
	winAFKPart = workspace:FindFirstChild("WinPart")
	if not exitPart then status.Text = "Status: EXIT not found"; return end
	if not winAFKPart then status.Text = "Status: WinPart not found"; return end

	if not exitOrigCFrame then exitOrigCFrame, exitOrigSize, exitOrigAnchored = exitPart.CFrame, exitPart.Size, exitPart.Anchored end
	if not winAFKOrigCFrame then winAFKOrigCFrame, winAFKOrigSize, winAFKOrigAnchored = winAFKPart.CFrame, winAFKPart.Size, winAFKPart.Anchored end

	afkEnabled = true

	exitPart.Anchored = true
	exitPart.Size = EXIT_TARGET_SIZE
	exitPart.CFrame = EXIT_TARGET_CF

	if afkTouchConn then afkTouchConn:Disconnect() afkTouchConn = nil end
	afkTouchConn = exitPart.Touched:Connect(function(hit)
		if not afkEnabled then return end
		local ch = player.Character
		if not ch or not hit or not hit:IsDescendantOf(ch) then return end
		local now = tick()
		if now - lastTouchAt < 0.25 then return end
		lastTouchAt = now
		local hrp = ch:FindFirstChild("HumanoidRootPart")
		if not hrp then return end
		if winAFKPart then
			winAFKPart.Anchored = true
			winAFKPart.Size = EXIT_TARGET_SIZE
			winAFKPart.CFrame = CFrame.new(hrp.Position)
		end
	end)

	setAFKEnabledUI()
	status.Text = "Status: AFK Auto Win enabled"
end)

afkDisableBtn.MouseButton1Click:Connect(function()
	if not afkEnabled then return end
	afkEnabled = false
	if afkTouchConn then afkTouchConn:Disconnect() afkTouchConn = nil end
	if exitPart and exitOrigCFrame then
		pcall(function()
			exitPart.Size = exitOrigSize
			exitPart.CFrame = exitOrigCFrame
			exitPart.Anchored = exitOrigAnchored
		end)
	end
	if winAFKPart and winAFKOrigCFrame then
		pcall(function()
			winAFKPart.Size = winAFKOrigSize
			winAFKPart.CFrame = winAFKOrigCFrame
			winAFKPart.Anchored = winAFKOrigAnchored
		end)
	end
	setAFKDisabledUI()
	status.Text = "Status: AFK Auto Win disabled"
end)

local enabled = false
local running = false
local winPart = nil
local targetCFrame = CFrame.new(-16.8024502, 57.4340744, -45.530674, 0,1,0, 1,0,0, 0,0,-1)

local function setEnabledUI()
	enableBtn.Text = "Enabled"
	enableBtn.BackgroundColor3 = Color3.fromRGB(70,68,90)
	disableBtn.Text = "Disable"
	disableBtn.BackgroundColor3 = PRIMARY
	disableBtn.TextColor3 = Color3.new(1,1,1)
end

local function setDisabledUI()
	enableBtn.Text = "Enable"
	enableBtn.BackgroundColor3 = PRIMARY
	disableBtn.Text = "Disabled"
	disableBtn.BackgroundColor3 = MUTED
	disableBtn.TextColor3 = TEXT
end

local function loop()
	if running then return end
	running = true
	while enabled do
		if not winPart then
			winPart = workspace:FindFirstChild("WinPart") or workspace:WaitForChild("WinPart", 5)
			if not winPart then
				status.Text = "Status: WinPart not found"
				enabled = false
				break
			end
		end
		local ch2 = player.Character
		local hrp2 = ch2 and ch2:FindFirstChild("HumanoidRootPart")
		if hrp2 and winPart then
			winPart.Anchored = true
			winPart.CFrame = CFrame.new(hrp2.Position)
			wait(0.25)
			winPart.CFrame = targetCFrame
		end
		wait(1)
	end
	running = false
end

enableBtn.MouseButton1Click:Connect(function()
	if enabled then return end
	if afkEnabled then status.Text = "Status: Disable AFK Auto Win first"; return end
	enabled = true
	_G.__AutoWinEnabled = true
	setEnabledUI()
	status.Text = "Status: Auto Win enabled"
	loop()
end)

disableBtn.MouseButton1Click:Connect(function()
	if not enabled then return end
	enabled = false
	_G.__AutoWinEnabled = nil
	if winPart then winPart.CFrame = targetCFrame end
	setDisabledUI()
	status.Text = "Status: Auto Win disabled"
end)

setDisabledUI()
setAFKDisabledUI()

local acEnabled = false
local acConns = {}
local disableList = {
	"AntiFly","AntiTeleportClient","AntiTeleport","DisableClimb",
	"CharacterTurnDelay","AntiHump","Main"
}

local function disconnectAll(tbl)
	for _,c in ipairs(tbl) do pcall(function() c:Disconnect() end) end
	table.clear(tbl)
end

local function forceDisableScript(scr)
	if scr and (scr:IsA("LocalScript") or scr:IsA("Script")) then
		if scr.Disabled ~= true then scr.Disabled = true end
		if not scr:GetAttribute("__hooked") then
			scr:SetAttribute("__hooked", true)
			table.insert(acConns, scr:GetPropertyChangedSignal("Disabled"):Connect(function()
				if acEnabled and scr.Disabled ~= true then scr.Disabled = true end
			end))
		end
	end
end

local function acEnforce(character)
	for _, n in ipairs(disableList) do
		for _, inst in ipairs(character:GetDescendants()) do
			if inst.Name == n then forceDisableScript(inst) end
		end
	end
	local authorized = character:FindFirstChild("AuthorizedTeleport")
	if authorized and authorized:IsA("BoolValue") then
		if authorized.Value == false then authorized.Value = true end
		if not authorized:GetAttribute("__hooked") then
			authorized:SetAttribute("__hooked", true)
			table.insert(acConns, authorized.Changed:Connect(function()
				if acEnabled and authorized.Value == false then authorized.Value = true end
			end))
		end
	end
end

local function acManageCharacter(character)
	acEnforce(character)
	table.insert(acConns, character.DescendantAdded:Connect(function(inst)
		if table.find(disableList, inst.Name) then forceDisableScript(inst) end
	end))
	local hb
	hb = RunService.Heartbeat:Connect(function()
		if not acEnabled then hb:Disconnect() return end
		acEnforce(character)
	end)
	table.insert(acConns, hb)
end

acBtn.MouseButton1Click:Connect(function()
	if acEnabled then return end
	acEnabled = true
	acBtn.Text = "Enabled"
	acBtn.BackgroundColor3 = Color3.fromRGB(70,68,90)
	status.Text = "Status: Anti Cheat bypass enabled + Infinite Yield loaded"
	pcall(function()
		loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
	end)
	if player.Character then acManageCharacter(player.Character) end
	table.insert(acConns, player.CharacterAdded:Connect(function(newChar)
		if acEnabled then acManageCharacter(newChar) end
	end))
end)

local minimized, saved = false, win.Size
minBtn.MouseButton1Click:Connect(function()
	minimized = not minimized
	if minimized then
		saved = win.Size
		TweenService:Create(win, TweenInfo.new(0.18, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = UDim2.fromOffset(BASE_W,56)}):Play()
		content.Visible = false
	else
		TweenService:Create(win, TweenInfo.new(0.18, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = saved}):Play()
		task.delay(0.18, function() content.Visible = true end)
	end
end)

closeBtn.MouseButton1Click:Connect(function()
	gui:Destroy()
	disconnectAll(acConns)
	acEnabled = false
	if afkTouchConn then afkTouchConn:Disconnect() end
end)

do
	local dragging = false
	local dragStart, startPos
	local function updateDrag(input)
		local delta = input.Position - dragStart
		win.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
	titleBar.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = win.Position
		end
	end)
	UIS.InputChanged:Connect(function(input)
		if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
			updateDrag(input)
		end
	end)
	UIS.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = false
		end
	end)
end

win.Size = UDim2.fromOffset(BASE_W, 0)
TweenService:Create(win, TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = UDim2.fromOffset(BASE_W, BASE_H)}):Play()
scanAndHookWeakPanels()
